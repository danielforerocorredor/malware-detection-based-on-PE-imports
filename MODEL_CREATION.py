import numpy as np 
import pandas as pd 
from sklearn import preprocessing
from sklearn import svm
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_val_score

#section headers dataset load and Data preprocessing 
PE_SH = pd.read_csv("DATA/pe_section_headers.csv",header = 0)

PE_SH = PE_SH.drop(labels = ["hash"], axis = 1)
x = PE_SH.values
min_max_scaler = preprocessing.MinMaxScaler()
x_scaled = min_max_scaler.fit_transform(x)
PE_SH = pd.DataFrame(x_scaled)

#model creation
X = PE_SH.iloc[:, 0:PE_I.columns.size - 1]
Y = PE_SH.iloc[:, -1]
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=42) 
linear_svm = svm.SVC(kernel='linear')
linear_svm.fit(X_train, Y_train)

#imports dataset load and Data preprocessing 
PE_I = pd.read_csv("DATA/top_1000_pe_imports.csv",header = 0)

PE_I = PE_I.drop(labels = "hash", axis = 1)
