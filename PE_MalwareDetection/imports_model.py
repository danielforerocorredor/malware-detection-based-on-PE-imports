import numpy as np 
import pandas as pd 
from sklearn import preprocessing
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_val_score


PE_I = pd.read_csv("/Users/danielforero/Desktop/MACHINE LEARNING TUB/PROJECT/DATA/top_1000_pe_imports.csv",header = 0)
PE_I = PE_I.drop(labels = "hash", axis = 1)
PE_I_1 = PE_I.iloc[0:2]
for i in range (np.int64(PE_I.iloc[:,-1].value_counts()[0])):
    if PE_I.iloc[i,-1] == 1:
        PE_I_1 = PE_I_1.append(PE_I.iloc[i])

for i in range (np.int64(PE_I.iloc[:,-1].value_counts()[1])):
    if PE_I.iloc[i,-1] == 0:
        PE_I_1 = PE_I_1.append(PE_I.iloc[i])
PE_I = PE_I_1
PE_I = PE_I.sample(frac=1).reset_index(drop=True)

import sklearn.tree as tree
from sklearn.tree import DecisionTreeClassifier
X = PE_I.iloc[:, 0:PE_I.columns.size - 1]
Y = PE_I.iloc[:, -1]

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.25, random_state=42) 
tree_classifier = DecisionTreeClassifier()
tree_classifier.fit(X_train, Y_train)

Y_pred = tree_classifier.predict(X_test)

print(tree_classifier.score(X_test, Y_test))

import pickle
pickle.dump(tree_classifier, open("/Users/danielforero/Desktop/MACHINE LEARNING TUB/PROJECT/MODELS/importModel.pickle", 'wb'))